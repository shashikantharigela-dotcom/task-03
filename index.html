<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Scroll Progress Indicator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bar-height: 6px;
      --bar-bg: linear-gradient(90deg, #22c55e, #3b82f6);
      --bar-bg-reduced: #22c55e;
      --track-bg: rgba(0,0,0,0.08);
      --z: 9999;
    }

    /* Track */
    .progress-track {
      position: fixed;
      top: 0; left: 0; right: 0;
      height: var(--bar-height);
      background: var(--track-bg);
      z-index: var(--z);
      overflow: hidden;
      /* subtle bevel for nice look */
      box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.763);
    }

    /* Fill uses transform for perf (GPU-friendly) */
    .progress-fill {
      position: absolute;
      inset: 0;
      transform: scaleX(0);
      transform-origin: left center;
      background: var(--bar-bg);
      will-change: transform;
    }

    /* Reduced motion: no gradient animation vibe, solid color */
    @media (prefers-reduced-motion: reduce) {
      .progress-fill { background: var(--bar-bg-reduced); }
    }

    /* Optional tiny % label (top-right) */
    .progress-label {
      position: fixed;
      top: calc(var(--bar-height) + 6px);
      right: 10px;
      font: 500 12px/1.2 system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      color: #334155;
      background: rgba(255, 255, 255, 0.8);
      padding: 4px 6px;
      border-radius: 6px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.08);
      z-index: var(--z);
      user-select: none;
    }

    /* Demo content styling */
    body {
      margin: 0;
      font: 16px/1.65 system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      color: #0f172a;
      background:linear-gradient(#40E0D0,#FF8C00,#FF0080);
    }
    header {
      padding: 64px 20px 24px;
      background-image: linear-gradient(135deg, white,lightgreen,darkblue);
      /* background: white; */
      position: sticky;
      top: var(--bar-height);
      border-bottom: 1px solid #e2e8f0;
    }
    main {
      max-width: 800px;
      margin: 0 auto;
      padding: 24px 20px 120vh; /* ensure long page for demo */
    }
    h1 { margin: 0 0 8px; font-size: 28px; }
    p.lead { margin: 0; color: #475569; }

    /* Hide track entirely if there’s no scrollable area */
    .progress-track[hidden],
    .progress-label[hidden] { display: none !important; }
  </style>
</head>
<body>
  <!-- Accessible progress bar -->
  <div
    class="progress-track"
    id="progressTrack"
    role="progressbar"
    aria-label="Reading progress"
    aria-valuemin="0"
    aria-valuemax="100"
    aria-valuenow="0"
  >
    <div class="progress-fill" id="progressFill"></div>
  </div>
  <div class="progress-label" id="progressLabel">0%</div>

  <header>
    <h1>tech.at.core</h1>
    <p class="lead">Enabling human-centric technology</p>
  </header>

  <main id="content">
    <h2>Building Tech That Matters</h2>
    <p>
      From inception through implementation, we’ve got you covered.
    </p>
    <p>
      We build tech that has a positive impact on society.
    </p>
    <p>
      Our values are important to us and impact our decisions on which projects to take on.
    </p>
    <p>
      We have built solutions to address complex challenges for enterprises, SMEs, and startups alike.
    </p>

    <!-- Extra filler to ensure scroll in the demo -->
    <div id="filler"></div>
  </main>

  <script>
    (function () {
      const track = document.getElementById('progressTrack');
      const fill = document.getElementById('progressFill');
      const label = document.getElementById('progressLabel');

      let ticking = false;
      let lastPct = 0;

      // Calculate scroll percentage (0–100).
      function getScrollPercent() {
        const doc = document.documentElement;
        // Total scrollable distance
        const max = doc.scrollHeight - doc.clientHeight;
        if (max <= 0) return 0;
        // How far we’ve scrolled
        const current = (doc.scrollTop || window.pageYOffset);
        return Math.max(0, Math.min(100, (current / max) * 100));
      }

      function update() {
        const pct = getScrollPercent();

        // If no scrolling is possible, hide UI.
        const noScroll = pct === 0 && (document.documentElement.scrollHeight <= document.documentElement.clientHeight);
        track.hidden = noScroll;
        label.hidden = noScroll;

        // Only write to DOM if value changed (avoid layout thrash).
        if (pct !== lastPct) {
          const scaleX = pct / 100;
          fill.style.transform = 'scaleX(' + scaleX + ')';
          track.setAttribute('aria-valuenow', pct.toFixed(0));
          label.textContent = pct.toFixed(0) + '%';
          lastPct = pct;
        }
        ticking = false;
      }

      function onScrollOrResize() {
        if (!ticking) {
          ticking = true;
          requestAnimationFrame(update);
        }
      }

      // React to dynamic content height changes
      const resizeObserver = new ResizeObserver(onScrollOrResize);
      resizeObserver.observe(document.documentElement);
      window.addEventListener('scroll', onScrollOrResize, { passive: true });
      window.addEventListener('resize', onScrollOrResize);

      // Initial paint
      update();

      // --- Demo-only: create some extra paragraphs for scrolling ---
      const filler = document.getElementById('filler');
      if (filler) {
        const frag = document.createDocumentFragment();
        for (let i = 0; i < 40; i++) {
          const p = document.createElement('p');
          p.textContent =
            'This paragraph is just filler to make the page tall.';
          frag.appendChild(p);
        }
        filler.appendChild(frag);
        // Recompute after adding content
        onScrollOrResize();
      }
    })();
  </script>
</body>
</html>
